<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kargo Etiketi - Yazdır</title>
<style>
  @page { size: 100mm 100mm; margin: 0; }
  html, body { width:100mm; height:100mm; margin:0; padding:0; }
  * { box-sizing: border-box; }

  body { font-family: Arial, sans-serif; }
  .label{
    position:relative; width:100mm; height:100mm; padding:5mm;
    display:flex; flex-direction:column; border:1px solid #000; overflow:hidden;
    page-break-inside: avoid;
  }

  /* ÜST SIRA: Barkod (sol) + QR (sağ) */
  .top-row{
    display:flex; align-items:flex-start; justify-content:space-between; gap:5mm; /* ↑ boşluk arttı */
    max-height:38mm; flex:0 0 auto;
  }
  .barcode-wrap{
    flex:1 1 auto; min-width:0; display:flex; flex-direction:column; align-items:center; overflow:hidden;
  }
  .barcode-wrap img{ max-width:100%; max-height:24mm; object-fit:contain; }
  .barcode-number{ font-size:12pt; font-weight:bold; margin-top:1.5mm; line-height:1.12; } /* ↑ boyut ve boşluk */

  .qr-wrap{
    flex:0 0 auto; width:26mm; height:26mm; display:flex; align-items:center; justify-content:center;
    border:1px solid #000; padding:1.2mm; background:#fff;
  }
  .qr-wrap img{ width:100%; height:100%; object-fit:contain; }

  /* Orta: Kargo firması */
  .cargo-provider{
    text-align:center; font-weight:bold; font-size:12pt; /* ↑ */
    margin:2.5mm 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex:0 0 auto;
  }

  /* Alt: Müşteri bilgileri — kalan alan */
  .customer-info{
    flex:1 1 auto; overflow:hidden; display:flex; flex-direction:column; gap:2.2mm; /* ↑ */
    min-height:0; font-size:10.5pt; /* ↑ genel metin */
  }
  .customer-info p{ margin:0; line-height:1.28; } /* ↑ satır aralığı */
  .order-number{ font-weight:bold; font-size:11.5pt; } /* ↑ */
  .name{ font-weight:bold; font-size:11pt; } /* ↑ */
  /* Satır kırpma */
  .clamp-1{ display:-webkit-box; -webkit-line-clamp:1; -webkit-box-orient:vertical; overflow:hidden; }
  .clamp-3{ display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden; }

  @media print { .label{ border:0; } }
</style>
</head>
<body>
  <div class="label">
    <!-- ÜST: Barkod (sol) + QR (sağ) -->
    <div class="top-row">
      <div class="barcode-wrap">
        {% if barcode_data_uri %}
          <img src="{{ barcode_data_uri }}" alt="Kargo Barkodu">
        {% else %}
          <div style="font-size:9pt">Barkod mevcut değil</div>
        {% endif %}
        {% if shipping_barcode %}
          <div class="barcode-number clamp-1">{{ shipping_barcode }}</div>
        {% endif %}
      </div>

      <div class="qr-wrap">
        {% if qr_code_path %}
          <img src="{{ url_for('static', filename=qr_code_path) }}" alt="QR Kod">
        {% else %}
          <div style="font-size:9pt;text-align:center;">QR Yok</div>
        {% endif %}
      </div>
    </div>

    <!-- Kargo Firması -->
    <div class="cargo-provider clamp-1">{{ cargo_provider_name }}</div>

    <!-- Müşteri Bilgileri -->
    <div class="customer-info">
      <p class="order-number clamp-1">Sipariş No: {{ order_number }}</p>
      <p class="name clamp-1">Alıcı: {{ customer_name }} {{ customer_surname }}</p>
      <p class="address clamp-3">{{ customer_address }}</p> <!-- ↑ adresi 3 satırla sınırladık -->
      <p class="phone clamp-1">Telefon: {{ telefon_no }}</p>
    </div>
  </div>

  <script>
    window.onload = function () {
      window.print();
      window.onafterprint = function () { window.close(); };
    };
  </script>
</body>
</html>
